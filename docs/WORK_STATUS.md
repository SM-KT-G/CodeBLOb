# ì‘ì—… í˜„í™© ë³´ê³ ì„œ
**ì‘ì„±ì¼ì‹œ**: 2024-11-09  
**ì‘ì—… ë¸Œëœì¹˜**: fastapi/backend/rag (ëª©í‘œ)  
**í˜„ì¬ ë¸Œëœì¹˜**: ckdlsxor (ë¬¸ì œ)

---

## ğŸ”´ í˜„ì¬ ìƒí™© (Critical Issues)

### 1. ì˜ëª»ëœ ë¸Œëœì¹˜ì—ì„œ ì‘ì—… ì¤‘
- **ë¬¸ì œ**: `ckdlsxor` ë¸Œëœì¹˜ì—ì„œ ì‘ì—… ì¤‘, ëª©í‘œëŠ” `fastapi/backend/rag`
- **ì˜í–¥**: ìµœê·¼ 4ê°œ ì»¤ë°‹ì´ ì˜ëª»ëœ ë¸Œëœì¹˜ì— ì €ì¥ë¨
- **í•´ê²° í•„ìš”**: ë¸Œëœì¹˜ ì „í™˜ ë° ì‘ì—… ì •ë¦¬

### 2. ìˆ˜ì •ëœ íŒŒì¼ (í˜„ì¬ uncommitted)
```
backend/itinerary.py          - ì—¬í–‰ ì¼ì • ì¶”ì²œ ê¸°ëŠ¥ (RAGì™€ ë¬´ê´€)
backend/main.py               - itinerary ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€ë¨
tests/test_itinerary_api.py   - itinerary í…ŒìŠ¤íŠ¸ ì½”ë“œ
docs/plan.md                  - ê°œë°œ ì›ì¹™ ë¬¸ì„œ (untracked)
```

### 3. ckdlsxor ë¸Œëœì¹˜ì˜ ìµœê·¼ 4ê°œ ì»¤ë°‹ (RAGì™€ ë¬´ê´€í•œ ì‘ì—…)
```
8718792d34: "chore: ì„ë² ë”© ì²´í¬í¬ì¸íŠ¸ ê°±ì‹ "
c2556a38f9: "feat: ì—¬í–‰ ì¶”ì²œ API ìŠ¤í‚¤ë§ˆì™€ ë¼ìš°íŠ¸ ì¶”ê°€"
c4ada31d0f: "docs: Node ì—°ë™ ê°€ì´ë“œì— expansion/ìºì‹œ ì§€í‘œ ì¶”ê°€"
ceb27063cc: "docs: ë¬¸ì„œ READMEì— ìµœì‹  í’ˆì§ˆ ë‹¨ê³„ ë°˜ì˜"
```
â†’ ì´ ì»¤ë°‹ë“¤ì€ ì—¬í–‰ ì¶”ì²œ(itinerary) ê¸°ëŠ¥ìœ¼ë¡œ RAG ë°±ì—”ë“œì™€ ë³„ê°œ

---

## âœ… ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­

1. **ëª©í‘œ ë ˆí¬ì§€í† ë¦¬**: https://github.com/SM-KT-G/CodeBLOb.git
2. **ëª©í‘œ ë¸Œëœì¹˜**: `fastapi/backend/rag`
3. **ì»¤ë°‹ ì „ëµ**: "ê¸°ëŠ¥ í•˜ë‚˜í•˜ë‚˜ë¥¼ ë‚˜ëˆ ì„œ ì»¤ë°‹ì˜ ìˆ˜ê°€ ìµœëŒ€í•œ ë§ê²Œ"
4. **ì œì™¸ ëŒ€ìƒ**: í…ŒìŠ¤íŠ¸ ì½”ë“œ, í™˜ê²½ë³€ìˆ˜ íŒŒì¼, ë°ì´í„° íŒŒì¼
5. **ë¬¸ì„œí™”**: README íŒŒì¼ì— ê° ì½”ë“œ ì„¤ëª… ì‘ì„±
6. **í•„ìˆ˜ ì¤€ìˆ˜**: `docs/plan.md`ì˜ TDD/Tidy First ì›ì¹™

---

## ğŸ“‹ plan.md í•„ìˆ˜ ì›ì¹™

### TDD ì‚¬ì´í´ (Red â†’ Green â†’ Refactor)
1. **Red**: ì‹¤íŒ¨í•˜ëŠ” í…ŒìŠ¤íŠ¸ ë¨¼ì € ì‘ì„±
2. **Green**: í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ëŠ” ìµœì†Œí•œì˜ ì½”ë“œ ì‘ì„±
3. **Refactor**: í…ŒìŠ¤íŠ¸ í†µê³¼ ìœ ì§€í•˜ë©° êµ¬ì¡° ê°œì„ 

### Tidy First ì›ì¹™
- **êµ¬ì¡°ì  ë³€ê²½**ê³¼ **í–‰ë™ì  ë³€ê²½**ì„ ì ˆëŒ€ ì„ì§€ ì•Šê¸°
- í•œ ì»¤ë°‹ = í•œ ê°€ì§€ ë…¼ë¦¬ì  ë‹¨ìœ„
- ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ ì‹œì—ë§Œ ì»¤ë°‹
- ì‘ê³  ë¹ˆë²ˆí•œ ì»¤ë°‹ > í¬ê³  ë“œë¬¸ ì»¤ë°‹

---

## ğŸ¯ RAG ë°±ì—”ë“œ íŒŒì¼ ëª©ë¡ (ì»¤ë°‹ ëŒ€ìƒ)

### í•µì‹¬ ëª¨ë“ˆ
1. **backend/llm_base.py** - OpenAI API ë˜í¼ (ë™ê¸°/ë¹„ë™ê¸°)
2. **backend/retriever.py** - ë²¡í„° ê²€ìƒ‰, HuggingFace ì„ë² ë”©, ì¿¼ë¦¬ í™•ì¥
3. **backend/rag_chain.py** - RAG íŒŒì´í”„ë¼ì¸ (LangChain)
4. **backend/main.py** - FastAPI ì•±, `/rag/query` ì—”ë“œí¬ì¸íŠ¸
5. **backend/schemas.py** - Pydantic ëª¨ë¸ (RAGRequest, RAGResponse ë“±)
6. **backend/cache.py** - Redis ìºì‹œ í†µí•©
7. **backend/query_expansion.py** - ì¿¼ë¦¬ í™•ì¥ ë¡œì§

### ë°ì´í„°ë² ì´ìŠ¤
8. **backend/db/connect.py** - PostgreSQL ì—°ê²° í’€
9. **backend/db/init_vector_v1.1.sql** - pgvector ìŠ¤í‚¤ë§ˆ

### ìœ í‹¸ë¦¬í‹°
10. **backend/utils/logger.py** - ë¡œê¹… ì„¤ì •

### ì„¤ì • íŒŒì¼
11. **.gitignore** - Git ì œì™¸ ê·œì¹™
12. **.env.example** - í™˜ê²½ë³€ìˆ˜ í…œí”Œë¦¿ (sanitized)
13. **requirements.txt** - Python ì˜ì¡´ì„±
14. **pyproject.toml** - í”„ë¡œì íŠ¸ ë©”íƒ€ë°ì´í„°
15. **docker-compose.yml** - PostgreSQL + pgvector ì„¤ì •

---

## âŒ ì»¤ë°‹ ì œì™¸ ëŒ€ìƒ

### í…ŒìŠ¤íŠ¸ íŒŒì¼ (ì‚¬ìš©ì ìš”ì²­ìœ¼ë¡œ ì œì™¸)
- `tests/` ë””ë ‰í† ë¦¬ ì „ì²´
- `test_*.py` íŒŒì¼ë“¤

### í™˜ê²½ë³€ìˆ˜
- `.env` - ì‹¤ì œ API í‚¤ í¬í•¨ (ë³´ì•ˆ)
- `.env.local` - ë¡œì»¬ ì„¤ì •

### ë°ì´í„° íŒŒì¼
- `labled_data/` - ëŒ€ìš©ëŸ‰ JSON ë°ì´í„°

### ë¬¸ì„œ (docs/ - ì‚¬ìš©ìê°€ ì œì™¸í•˜ë¼ê³  ëª…ì‹œ)
- `docs/` ë””ë ‰í† ë¦¬ ì „ì²´

### ê¸°íƒ€
- `__pycache__/`, `.pytest_cache/` - ìºì‹œ íŒŒì¼
- `scripts/` - ì„ë² ë”© ìŠ¤í¬ë¦½íŠ¸ (ë°ì´í„° ì²˜ë¦¬ìš©)

---

## ğŸš€ ì‘ì—… ê³„íš

### Phase 1: ë¸Œëœì¹˜ ì •ë¦¬ (í˜„ì¬ ë‹¨ê³„)
1. âœ… í˜„ì¬ ìƒí™© ë¬¸ì„œí™” (`docs/WORK_STATUS.md`)
2. â³ ckdlsxor ë¸Œëœì¹˜ì˜ ìˆ˜ì •ì‚¬í•­ ì²˜ë¦¬ ê²°ì •
   - **ì˜µì…˜ A**: í˜„ì¬ ìˆ˜ì •ì‚¬í•­ì„ ckdlsxorì— ì»¤ë°‹ (itinerary ê¸°ëŠ¥)
   - **ì˜µì…˜ B**: ìˆ˜ì •ì‚¬í•­ì„ stashí•˜ê³  ë‚˜ì¤‘ì— ì²˜ë¦¬
   - **ê¶Œì¥**: ì˜µì…˜ A - itineraryëŠ” ë³„ë„ ê¸°ëŠ¥ì´ë¯€ë¡œ ckdlsxorì— ë‚¨ê¸°ê¸°
3. â³ `docs/plan.md`ë¥¼ gitì— ì¶”ê°€ (í˜„ì¬ untracked)
4. â³ `fastapi/backend/rag` ë¸Œëœì¹˜ë¡œ ì „í™˜
5. â³ `fastapi/backend/rag` ë¸Œëœì¹˜ ìƒíƒœ í™•ì¸

### Phase 2: RAG ë°±ì—”ë“œ ê°œë³„ ì»¤ë°‹ (plan.md ì¤€ìˆ˜)
ê° íŒŒì¼ì— ëŒ€í•´ ë‹¤ìŒ ìˆœì„œë¡œ ì‘ì—…:

1. **backend/llm_base.py**
   - ì»¤ë°‹ ë©”ì‹œì§€: `feat: OpenAI API ë˜í¼ ì¶”ê°€ (ë™ê¸°/ë¹„ë™ê¸° í´ë¼ì´ì–¸íŠ¸)`
   - ì„¤ëª…: OpenAI GPT ëª¨ë¸ í˜¸ì¶œì„ ìœ„í•œ ë™ê¸°/ë¹„ë™ê¸° ì¸í„°í˜ì´ìŠ¤

2. **backend/db/connect.py**
   - ì»¤ë°‹ ë©”ì‹œì§€: `feat: PostgreSQL ì—°ê²° í’€ ê´€ë¦¬ì ì¶”ê°€`
   - ì„¤ëª…: pgvector ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í’€ë§

3. **backend/db/init_vector_v1.1.sql**
   - ì»¤ë°‹ ë©”ì‹œì§€: `feat: pgvector ìŠ¤í‚¤ë§ˆ ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸`
   - ì„¤ëª…: ë²¡í„° ê²€ìƒ‰ì„ ìœ„í•œ í…Œì´ë¸” ë° ì¸ë±ìŠ¤ ìƒì„±

4. **backend/utils/logger.py**
   - ì»¤ë°‹ ë©”ì‹œì§€: `feat: êµ¬ì¡°í™”ëœ ë¡œê¹… ìœ í‹¸ë¦¬í‹° ì¶”ê°€`
   - ì„¤ëª…: ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ë°˜ì˜ ë¡œê¹… ì„¤ì •

5. **backend/schemas.py**
   - ì»¤ë°‹ ë©”ì‹œì§€: `feat: RAG API Pydantic ìŠ¤í‚¤ë§ˆ ì •ì˜`
   - ì„¤ëª…: ìš”ì²­/ì‘ë‹µ ë°ì´í„° ê²€ì¦ ëª¨ë¸

6. **backend/query_expansion.py**
   - ì»¤ë°‹ ë©”ì‹œì§€: `feat: ì¿¼ë¦¬ í™•ì¥ ë¡œì§ êµ¬í˜„`
   - ì„¤ëª…: ê²€ìƒ‰ ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•œ ì¿¼ë¦¬ í™•ì¥

7. **backend/retriever.py**
   - ì»¤ë°‹ ë©”ì‹œì§€: `feat: ë²¡í„° ê²€ìƒ‰ ë¦¬íŠ¸ë¦¬ë²„ êµ¬í˜„`
   - ì„¤ëª…: HuggingFace ì„ë² ë”© + pgvector ê²€ìƒ‰ + ì¿¼ë¦¬ í™•ì¥

8. **backend/cache.py**
   - ì»¤ë°‹ ë©”ì‹œì§€: `feat: Redis ìºì‹œ í†µí•©`
   - ì„¤ëª…: ê²€ìƒ‰ ê²°ê³¼ ìºì‹±ìœ¼ë¡œ ì„±ëŠ¥ ìµœì í™”

9. **backend/rag_chain.py**
   - ì»¤ë°‹ ë©”ì‹œì§€: `feat: LangChain RAG íŒŒì´í”„ë¼ì¸ êµ¬í˜„`
   - ì„¤ëª…: ê²€ìƒ‰ + LLM ìƒì„± í†µí•© ì²´ì¸

10. **backend/main.py**
    - ì»¤ë°‹ ë©”ì‹œì§€: `feat: FastAPI ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ (RAG ì—”ë“œí¬ì¸íŠ¸)`
    - ì„¤ëª…: `/rag/query`, `/health` ì—”ë“œí¬ì¸íŠ¸ ì œê³µ

11. **.gitignore**
    - ì»¤ë°‹ ë©”ì‹œì§€: `chore: Git ì œì™¸ ê·œì¹™ ì„¤ì •`
    - ì„¤ëª…: í™˜ê²½ë³€ìˆ˜, ìºì‹œ, ë°ì´í„° íŒŒì¼ ì œì™¸

12. **.env.example**
    - ì»¤ë°‹ ë©”ì‹œì§€: `chore: í™˜ê²½ë³€ìˆ˜ í…œí”Œë¦¿ ì¶”ê°€`
    - ì„¤ëª…: í•„ìš”í•œ í™˜ê²½ë³€ìˆ˜ ê°€ì´ë“œ (sanitized)

13. **requirements.txt**
    - ì»¤ë°‹ ë©”ì‹œì§€: `chore: Python ì˜ì¡´ì„± ëª©ë¡`
    - ì„¤ëª…: FastAPI, LangChain, pgvector ë“±

14. **pyproject.toml**
    - ì»¤ë°‹ ë©”ì‹œì§€: `chore: í”„ë¡œì íŠ¸ ë©”íƒ€ë°ì´í„° ì„¤ì •`
    - ì„¤ëª…: í”„ë¡œì íŠ¸ ì •ë³´ ë° ë¹Œë“œ ì„¤ì •

15. **docker-compose.yml**
    - ì»¤ë°‹ ë©”ì‹œì§€: `chore: PostgreSQL + pgvector ë„ì»¤ ì„¤ì •`
    - ì„¤ëª…: ë¡œì»¬ ê°œë°œ í™˜ê²½ êµ¬ì„±

### Phase 3: ë¬¸ì„œí™”
- README.md ì—…ë°ì´íŠ¸ (ê° íŒŒì¼ ì„¤ëª… ì¶”ê°€)
- ì»¤ë°‹ ë©”ì‹œì§€: `docs: RAG ë°±ì—”ë“œ README ì‘ì„±`

### Phase 4: í‘¸ì‹œ
```bash
git push origin fastapi/backend/rag
```

---

## âš ï¸ ì¦‰ì‹œ ê²°ì • í•„ìš”

### ì§ˆë¬¸: í˜„ì¬ ckdlsxor ë¸Œëœì¹˜ì˜ ìˆ˜ì •ì‚¬í•­ ì²˜ë¦¬ ë°©ë²•?

**í˜„ì¬ ìˆ˜ì •ëœ íŒŒì¼**:
- `backend/itinerary.py` - ì—¬í–‰ ì¼ì • ì¶”ì²œ ê¸°ëŠ¥
- `backend/main.py` - itinerary ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€
- `tests/test_itinerary_api.py` - í…ŒìŠ¤íŠ¸ ì½”ë“œ

**ì˜µì…˜**:

1. **[ê¶Œì¥] ckdlsxorì— ì»¤ë°‹í•˜ê³  RAG ë¸Œëœì¹˜ë¡œ ì „í™˜**
   ```bash
   git add backend/itinerary.py backend/main.py tests/test_itinerary_api.py docs/plan.md
   git commit -m "feat: ì—¬í–‰ ì¼ì • ì¶”ì²œ API ì™„ì„± + ê°œë°œ ì›ì¹™ ë¬¸ì„œ ì¶”ê°€"
   git checkout fastapi/backend/rag
   ```
   - ì¥ì : itinerary ê¸°ëŠ¥ ë³´ì¡´, RAGì™€ ë¶„ë¦¬
   - ë‹¨ì : ckdlsxor ë¸Œëœì¹˜ì— ê³„ì† ì‘ì—… ìŒ“ì„

2. **stashí•˜ê³  ë‚˜ì¤‘ì— ì²˜ë¦¬**
   ```bash
   git stash push -m "itinerary feature WIP"
   git checkout fastapi/backend/rag
   ```
   - ì¥ì : ì¦‰ì‹œ RAG ì‘ì—… ê°€ëŠ¥
   - ë‹¨ì : ë‚˜ì¤‘ì— stash ì²˜ë¦¬ í•„ìš”

3. **ë³€ê²½ì‚¬í•­ ë²„ë¦¬ê¸°**
   ```bash
   git checkout -- backend/itinerary.py backend/main.py tests/test_itinerary_api.py
   git checkout fastapi/backend/rag
   ```
   - ì¥ì : ê¹”ë”í•˜ê²Œ ì‹œì‘
   - ë‹¨ì : itinerary ì‘ì—… ì†ì‹¤

**ê¶Œì¥**: ì˜µì…˜ 1 - itineraryëŠ” ë³„ë„ ê¸°ëŠ¥ì´ë¯€ë¡œ ckdlsxorì— ì»¤ë°‹ í›„ RAG ì‘ì—… ì§„í–‰

---

## ğŸ“Š ë‹¤ìŒ ë‹¨ê³„ (ì‚¬ìš©ì í™•ì¸ í›„)

1. ckdlsxor ìˆ˜ì •ì‚¬í•­ ì²˜ë¦¬ (ìœ„ ì˜µì…˜ ì¤‘ ì„ íƒ)
2. fastapi/backend/rag ë¸Œëœì¹˜ë¡œ ì „í™˜
3. ë¸Œëœì¹˜ ìƒíƒœ í™•ì¸ (ê¸°ì¡´ ì»¤ë°‹ í™•ì¸)
4. RAG ë°±ì—”ë“œ íŒŒì¼ 15ê°œë¥¼ ê°œë³„ ì»¤ë°‹ (plan.md ì¤€ìˆ˜)
5. README.md ì‘ì„± (ê° íŒŒì¼ ìƒì„¸ ì„¤ëª…)
6. origin/fastapi/backend/ragë¡œ í‘¸ì‹œ
7. ëª¨ë“  ë¬¸ì„œ ìµœì‹ í™”

---

## ğŸ“ ì‘ì—… ì‹œê°„ ì˜ˆìƒ

- Phase 1 (ë¸Œëœì¹˜ ì •ë¦¬): 10ë¶„
- Phase 2 (15ê°œ íŒŒì¼ ê°œë³„ ì»¤ë°‹): 30-45ë¶„
- Phase 3 (README ë¬¸ì„œí™”): 15-20ë¶„
- Phase 4 (í‘¸ì‹œ ë° ê²€ì¦): 5ë¶„
- **ì´ ì˜ˆìƒ ì‹œê°„**: ì•½ 1ì‹œê°„
